<!DOCTYPE html><html><head><meta charset=utf-8><title>django.db.migrations.loader.MigrationLoader</title><meta name=viewport content="width=device-width, initial-scale=1.0"><link rel=stylesheet href=./assets/purecss/pure-min.css><link rel=stylesheet href=./assets/purecss/grids-responsive-min.css><link rel=stylesheet href=./assets/style.css><link rel=stylesheet href=./assets/pygments/default.css><link rel=stylesheet href=./assets/jquery/jquery-ui.min.css><script src=./assets/jquery/jquery-3.0.0.min.js></script><script src=./assets/jquery/jquery-ui.min.js></script><script src=nedoc.js></script></head><body><div id=layout class=pure-g><div class="sidebar pure-u-1 pure-u-md-1-4"><div class=header><h1 class=brand-title>Django</h1> 1.0 </div><div id=sbox><input id=search style="color: black;" placeholder="search ..."></div><div class=tree><ul><li><a href=django.html>&#9662; django</a> </li><li><ul><li><a href=django.__main__.html>&#9656; __main__</a> </li><li><a href=django.apps.html>&#9656; apps</a> </li><li><a href=django.bin.html>&#9656; bin</a> </li><li><a href=django.conf.html>&#9656; conf</a> </li><li><a href=django.contrib.html>&#9656; contrib</a> </li><li><a href=django.core.html>&#9656; core</a> </li><li><a href=django.db.html>&#9662; db</a> </li><li><ul><li><a href=django.db.backends.html>&#9656; backends</a> </li><li><a href=django.db.migrations.html>&#9662; migrations</a> </li><li><ul><li><a href=django.db.migrations.autodetector.html>&#9656; autodetector</a> </li><li><a href=django.db.migrations.exceptions.html>&#9656; exceptions</a> </li><li><a href=django.db.migrations.executor.html>&#9656; executor</a> </li><li><a href=django.db.migrations.graph.html>&#9656; graph</a> </li><li><a href=django.db.migrations.loader.html>&#9662; loader</a> </li><li><ul><li><div class=select><a href=django.db.migrations.loader.MigrationLoader.html> <i>class</i> MigrationLoader</a> </div></li></ul></li><li><a href=django.db.migrations.migration.html>&#9656; migration</a> </li><li><a href=django.db.migrations.operations.html>&#9656; operations</a> </li><li><a href=django.db.migrations.optimizer.html>&#9656; optimizer</a> </li><li><a href=django.db.migrations.questioner.html>&#9656; questioner</a> </li><li><a href=django.db.migrations.recorder.html>&#9656; recorder</a> </li><li><a href=django.db.migrations.serializer.html>&#9656; serializer</a> </li><li><a href=django.db.migrations.state.html>&#9656; state</a> </li><li><a href=django.db.migrations.utils.html>&#9656; utils</a> </li><li><a href=django.db.migrations.writer.html>&#9656; writer</a> </li></ul></li><li><a href=django.db.models.html>&#9656; models</a> </li><li><a href=django.db.transaction.html>&#9656; transaction</a> </li><li><a href=django.db.utils.html>&#9656; utils</a> </li><li><a href=django.db.DefaultConnectionProxy.html> <i>class</i> DefaultConnectionProxy</a> </li></ul></li><li><a href=django.dispatch.html>&#9656; dispatch</a> </li><li><a href=django.forms.html>&#9656; forms</a> </li><li><a href=django.http.html>&#9656; http</a> </li><li><a href=django.middleware.html>&#9656; middleware</a> </li><li><a href=django.shortcuts.html>&#9656; shortcuts</a> </li><li><a href=django.template.html>&#9656; template</a> </li><li><a href=django.templatetags.html>&#9656; templatetags</a> </li><li><a href=django.test.html>&#9656; test</a> </li><li><a href=django.urls.html>&#9656; urls</a> </li><li><a href=django.utils.html>&#9656; utils</a> </li><li><a href=django.views.html>&#9656; views</a> </li></ul></ul></div></div><div class="content pure-u-1 pure-u-md-3-4"><h1>Class MigrationLoader</h1><div id=path><a class=symbol href=django.html>django</a>.<a class=symbol href=django.db.html>db</a>.<a class=symbol href=django.db.migrations.html>migrations</a>.<a class=symbol href=django.db.migrations.loader.html>loader</a>.<a class=symbol href=django.db.migrations.loader.MigrationLoader.html>MigrationLoader</a></div><p><div class=docline> Load migration files from disk and their status from the database. </div></p><h2>Declaration</h2><div class=decl><span class=kw>class</span> MigrationLoader</div><a class=sourcelink href=source+django.db.migrations.loader.py.html#line-17>source</a> <a class=sourcelink href=django.db.migrations.loader.MigrationLoader.html>link</a><h2>Documentation</h2><pre>Migration files are expected to live in the &#34;migrations&#34; directory of
an app. Their names are entirely unimportant from a code perspective,
but will probably follow the 1234_name.py convention.

On initialization, this class will scan those directories, and open and
read the Python files, looking for a class called Migration, which should
inherit from django.db.migrations.Migration. See
django.db.migrations.migration for what that looks like.

Some migrations will be marked as &#34;replacing&#34; another set of migrations.
These are loaded into a separate set of migrations away from the main ones.
If all the migrations they replace are either unapplied or missing from
disk, then they are injected into the main set, replacing the named migrations.
Any dependency pointers to the replaced migrations are re-pointed to the
new migration.

This does mean that this class MUST also talk to the database as well as
to disk, but this is probably fine. We&#39;re already not just operating
in memory.</pre><h2>Methods</h2><ul class=deflst><li><div class=fn><a id=f___init__></a><div class=fshort><span class=def><span class=ftoggle-empty>&#9655;</span> def <a class="fexpand symbol-no-doc" href=django.db.migrations.loader.MigrationLoader.html#f___init__>__init__</a>(<span class=args>self, connection, load=True, ignore_no_migrations=False, replace_migrations=True</span>) </span></div><div class=fdetail id=fn___init__><div class=idnt><a class=sourcelink href=source+django.db.migrations.loader.py.html#line-42>source</a> <a class=sourcelink href=django.db.migrations.loader.MigrationLoader.html#f___init__>link</a></div></div></div></li><li><div class=fn><a id=f_add_external_dependencies></a><div class=fshort><span class=def><span class=ftoggle-empty>&#9655;</span> def <a class="fexpand symbol-no-doc" href=django.db.migrations.loader.MigrationLoader.html#f_add_external_dependencies>add_external_dependencies</a>(<span class=args>self, key, migration</span>) </span></div><div class=fdetail id=fn_add_external_dependencies><div class=idnt><a class=sourcelink href=source+django.db.migrations.loader.py.html#line-189>source</a> <a class=sourcelink href=django.db.migrations.loader.MigrationLoader.html#f_add_external_dependencies>link</a></div></div></div></li><li><div class=fn><a id=f_add_internal_dependencies></a><div class=fshort><span class=def><span class=ftoggle-empty>&#9655;</span> def <a class="fexpand symbol" href=django.db.migrations.loader.MigrationLoader.html#f_add_internal_dependencies>add_internal_dependencies</a>(<span class=args>self, key, migration</span>) </span><div class=docline> Internal dependencies need to be added first to ensure `__first__` dependencies find the correct root node. </div></div><div class=fdetail id=fn_add_internal_dependencies><div class=idnt><a class=sourcelink href=source+django.db.migrations.loader.py.html#line-179>source</a> <a class=sourcelink href=django.db.migrations.loader.MigrationLoader.html#f_add_internal_dependencies>link</a></div></div></div></li><li><div class=fn><a id=f_build_graph></a><div class=fshort><span class=def><span class=ftoggle-empty>&#9655;</span> def <a class="fexpand symbol" href=django.db.migrations.loader.MigrationLoader.html#f_build_graph>build_graph</a>(<span class=args>self</span>) </span><div class=docline> Build a migration dependency graph using both the disk and database. You&#39;ll need to rebuild the graph if you apply migrations. This isn&#39;t usually a problem as generally migration stuff runs in a one-shot process. </div></div><div class=fdetail id=fn_build_graph><div class=idnt><a class=sourcelink href=source+django.db.migrations.loader.py.html#line-202>source</a> <a class=sourcelink href=django.db.migrations.loader.MigrationLoader.html#f_build_graph>link</a></div></div></div></li><li><div class=fn><a id=f_check_consistent_history></a><div class=fshort><span class=def><span class=ftoggle-empty>&#9655;</span> def <a class="fexpand symbol" href=django.db.migrations.loader.MigrationLoader.html#f_check_consistent_history>check_consistent_history</a>(<span class=args>self, connection</span>) </span><div class=docline> Raise InconsistentMigrationHistory if any applied migrations have unapplied dependencies. </div></div><div class=fdetail id=fn_check_consistent_history><div class=idnt><a class=sourcelink href=source+django.db.migrations.loader.py.html#line-283>source</a> <a class=sourcelink href=django.db.migrations.loader.MigrationLoader.html#f_check_consistent_history>link</a></div></div></div></li><li><div class=fn><a id=f_check_key></a><div class=fshort><span class=def><span class=ftoggle-empty>&#9655;</span> def <a class="fexpand symbol-no-doc" href=django.db.migrations.loader.MigrationLoader.html#f_check_key>check_key</a>(<span class=args>self, key, current_app</span>) </span></div><div class=fdetail id=fn_check_key><div class=idnt><a class=sourcelink href=source+django.db.migrations.loader.py.html#line-151>source</a> <a class=sourcelink href=django.db.migrations.loader.MigrationLoader.html#f_check_key>link</a></div></div></div></li><li><div class=fn><a id=f_collect_sql></a><div class=fshort><span class=def><span class=ftoggle-empty>&#9655;</span> def <a class="fexpand symbol" href=django.db.migrations.loader.MigrationLoader.html#f_collect_sql>collect_sql</a>(<span class=args>self, plan</span>) </span><div class=docline> Take a migration plan and return a list of collected SQL statements that represent the best-efforts version of that plan. </div></div><div class=fdetail id=fn_collect_sql><div class=idnt><a class=sourcelink href=source+django.db.migrations.loader.py.html#line-332>source</a> <a class=sourcelink href=django.db.migrations.loader.MigrationLoader.html#f_collect_sql>link</a></div></div></div></li><li><div class=fn><a id=f_detect_conflicts></a><div class=fshort><span class=def><span class=ftoggle-empty>&#9655;</span> def <a class="fexpand symbol" href=django.db.migrations.loader.MigrationLoader.html#f_detect_conflicts>detect_conflicts</a>(<span class=args>self</span>) </span><div class=docline> Look through the loaded graph and detect any conflicts - apps with more than one leaf migration. Return a dict of the app labels that conflict with the migration names that conflict. </div></div><div class=fdetail id=fn_detect_conflicts><div class=idnt><a class=sourcelink href=source+django.db.migrations.loader.py.html#line-309>source</a> <a class=sourcelink href=django.db.migrations.loader.MigrationLoader.html#f_detect_conflicts>link</a></div></div></div></li><li><div class=fn><a id=f_get_migration></a><div class=fshort><span class=def><span class=ftoggle-empty>&#9655;</span> def <a class="fexpand symbol" href=django.db.migrations.loader.MigrationLoader.html#f_get_migration>get_migration</a>(<span class=args>self, app_label, name_prefix</span>) </span><div class=docline> Return the named migration or raise NodeNotFoundError. </div></div><div class=fdetail id=fn_get_migration><div class=idnt><a class=sourcelink href=source+django.db.migrations.loader.py.html#line-129>source</a> <a class=sourcelink href=django.db.migrations.loader.MigrationLoader.html#f_get_migration>link</a></div></div></div></li><li><div class=fn><a id=f_get_migration_by_prefix></a><div class=fshort><span class=def><span class=ftoggle-empty>&#9655;</span> def <a class="fexpand symbol" href=django.db.migrations.loader.MigrationLoader.html#f_get_migration_by_prefix>get_migration_by_prefix</a>(<span class=args>self, app_label, name_prefix</span>) </span><div class=docline> Return the migration(s) which match the given app label and name_prefix. </div></div><div class=fdetail id=fn_get_migration_by_prefix><div class=idnt><a class=sourcelink href=source+django.db.migrations.loader.py.html#line-133>source</a> <a class=sourcelink href=django.db.migrations.loader.MigrationLoader.html#f_get_migration_by_prefix>link</a></div></div></div></li><li><div class=fn><a id=f_load_disk></a><div class=fshort><span class=def><span class=ftoggle-empty>&#9655;</span> def <a class="fexpand symbol" href=django.db.migrations.loader.MigrationLoader.html#f_load_disk>load_disk</a>(<span class=args>self</span>) </span><div class=docline> Load the migrations from all INSTALLED_APPS from disk. </div></div><div class=fdetail id=fn_load_disk><div class=idnt><a class=sourcelink href=source+django.db.migrations.loader.py.html#line-67>source</a> <a class=sourcelink href=django.db.migrations.loader.MigrationLoader.html#f_load_disk>link</a></div></div></div></li><li><div class=fn><a id=f_project_state></a><div class=fshort><span class=def><span class=ftoggle>&#9654;</span> def <a class="fexpand symbol" href=django.db.migrations.loader.MigrationLoader.html#f_project_state>project_state</a>(<span class=args>self, nodes=None, at_end=True</span>) </span><div class=docline> Return a ProjectState object representing the most recent state that the loaded migrations represent. </div></div><div class=fdetail id=fn_project_state><div class=idnt><a class=sourcelink href=source+django.db.migrations.loader.py.html#line-323>source</a> <a class=sourcelink href=django.db.migrations.loader.MigrationLoader.html#f_project_state>link</a></div><pre>See graph.make_state() for the meaning of &#34;nodes&#34; and &#34;at_end&#34;.</pre></div></div></li></ul><h2>Class methods</h2><ul class=deflst><li><div class=fn><a id=f_migrations_module></a><div class=fshort><span class=def><span class=ftoggle-empty>&#9655;</span> def <a class="fexpand symbol" href=django.db.migrations.loader.MigrationLoader.html#f_migrations_module>migrations_module</a>(<span class=args>cls, app_label</span>) <span class=label>@classmethod</span></span><div class=docline> Return the path to the migrations module for the specified app_label and a boolean indicating if the module is specified in settings.MIGRATION_MODULE. </div></div><div class=fdetail id=fn_migrations_module><div class=decl><div class=def><i> @classmethod<br></i><span class=kw>def</span> migrations_module( <div class=args style="padding-left: 2em">cls,</div><div class=args style="padding-left: 2em">app_label,</div> ) </div></div><div class=idnt><a class=sourcelink href=source+django.db.migrations.loader.py.html#line-55>source</a> <a class=sourcelink href=django.db.migrations.loader.MigrationLoader.html#f_migrations_module>link</a></div></div></div></li></ul><h2>Reexports</h2><ul class=deflst><li> Imported in <a class=symbol href=django.core.management.commands.sqlmigrate.html>django.core.management.commands.sqlmigrate</a>. </li><li> Imported in <a class=symbol href=django.core.management.commands.showmigrations.html>django.core.management.commands.showmigrations</a>. </li><li> Imported in <a class=symbol href=django.core.management.commands.makemigrations.html>django.core.management.commands.makemigrations</a>. </li><li> Imported in <a class=symbol href=django.core.management.commands.squashmigrations.html>django.core.management.commands.squashmigrations</a>. </li><li> Imported in <a class=symbol href=django.db.migrations.writer.html>django.db.migrations.writer</a>. </li><li> Imported in <a class=symbol href=django.db.migrations.questioner.html>django.db.migrations.questioner</a>. </li><li> Imported in <a class=symbol href=django.db.migrations.executor.html>django.db.migrations.executor</a>. </li></ul><p class=footer> Generated by <a href=https://github.com/spirali/nedoc>nedoc</a> v0.9 at 2020-12-29 14:04 </p></div></div></body></html>