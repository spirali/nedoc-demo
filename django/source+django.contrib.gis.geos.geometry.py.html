<!DOCTYPE html><html><head><meta charset=utf-8><title>django.contrib.gis.geos.geometry</title><meta name=viewport content="width=device-width, initial-scale=1.0"><link rel=stylesheet href=./assets/purecss/pure-min.css><link rel=stylesheet href=./assets/purecss/grids-responsive-min.css><link rel=stylesheet href=./assets/style.css><link rel=stylesheet href=./assets/pygments/default.css><link rel=stylesheet href=./assets/jquery/jquery-ui.min.css><script src=./assets/jquery/jquery-3.0.0.min.js></script><script src=./assets/jquery/jquery-ui.min.js></script><script src=nedoc.js></script></head><body><div id=layout class=pure-g><div class="sidebar pure-u-1 pure-u-md-1-4"><div class=header><h1 class=brand-title>Django</h1> 1.0 </div><div id=sbox><input id=search style="color: black;" placeholder="search ..."></div><div class=tree><ul><li><a href=django.html>&#9662; django</a> </li><li><ul><li><a href=django.__main__.html>&#9656; __main__</a> </li><li><a href=django.apps.html>&#9656; apps</a> </li><li><a href=django.bin.html>&#9656; bin</a> </li><li><a href=django.conf.html>&#9656; conf</a> </li><li><a href=django.contrib.html>&#9662; contrib</a> </li><li><ul><li><a href=django.contrib.admin.html>&#9656; admin</a> </li><li><a href=django.contrib.admindocs.html>&#9656; admindocs</a> </li><li><a href=django.contrib.auth.html>&#9656; auth</a> </li><li><a href=django.contrib.contenttypes.html>&#9656; contenttypes</a> </li><li><a href=django.contrib.flatpages.html>&#9656; flatpages</a> </li><li><a href=django.contrib.gis.html>&#9662; gis</a> </li><li><ul><li><a href=django.contrib.gis.admin.html>&#9656; admin</a> </li><li><a href=django.contrib.gis.apps.html>&#9656; apps</a> </li><li><a href=django.contrib.gis.db.html>&#9656; db</a> </li><li><a href=django.contrib.gis.feeds.html>&#9656; feeds</a> </li><li><a href=django.contrib.gis.forms.html>&#9656; forms</a> </li><li><a href=django.contrib.gis.gdal.html>&#9656; gdal</a> </li><li><a href=django.contrib.gis.geoip2.html>&#9656; geoip2</a> </li><li><a href=django.contrib.gis.geometry.html>&#9656; geometry</a> </li><li><a href=django.contrib.gis.geos.html>&#9662; geos</a> </li><li><ul><li><a href=django.contrib.gis.geos.base.html>&#9656; base</a> </li><li><a href=django.contrib.gis.geos.collections.html>&#9656; collections</a> </li><li><a href=django.contrib.gis.geos.coordseq.html>&#9656; coordseq</a> </li><li><a href=django.contrib.gis.geos.error.html>&#9656; error</a> </li><li><a href=django.contrib.gis.geos.factory.html>&#9656; factory</a> </li><li><div class=select><a href=django.contrib.gis.geos.geometry.html>&#9662; geometry</a> </div></li><li><ul><li><a href=django.contrib.gis.geos.geometry.GEOSGeometry.html> <i>class</i> GEOSGeometry</a> </li><li><a href=django.contrib.gis.geos.geometry.GEOSGeometryBase.html> <i>class</i> GEOSGeometryBase</a> </li><li><a href=django.contrib.gis.geos.geometry.LinearGeometryMixin.html> <i>class</i> LinearGeometryMixin</a> </li></ul></li><li><a href=django.contrib.gis.geos.io.html>&#9656; io</a> </li><li><a href=django.contrib.gis.geos.libgeos.html>&#9656; libgeos</a> </li><li><a href=django.contrib.gis.geos.linestring.html>&#9656; linestring</a> </li><li><a href=django.contrib.gis.geos.mutable_list.html>&#9656; mutable_list</a> </li><li><a href=django.contrib.gis.geos.point.html>&#9656; point</a> </li><li><a href=django.contrib.gis.geos.polygon.html>&#9656; polygon</a> </li><li><a href=django.contrib.gis.geos.prepared.html>&#9656; prepared</a> </li><li><a href=django.contrib.gis.geos.prototypes.html>&#9656; prototypes</a> </li></ul></li><li><a href=django.contrib.gis.management.html>&#9656; management</a> </li><li><a href=django.contrib.gis.measure.html>&#9656; measure</a> </li><li><a href=django.contrib.gis.ptr.html>&#9656; ptr</a> </li><li><a href=django.contrib.gis.serializers.html>&#9656; serializers</a> </li><li><a href=django.contrib.gis.shortcuts.html>&#9656; shortcuts</a> </li><li><a href=django.contrib.gis.sitemaps.html>&#9656; sitemaps</a> </li><li><a href=django.contrib.gis.utils.html>&#9656; utils</a> </li><li><a href=django.contrib.gis.views.html>&#9656; views</a> </li></ul></li><li><a href=django.contrib.humanize.html>&#9656; humanize</a> </li><li><a href=django.contrib.messages.html>&#9656; messages</a> </li><li><a href=django.contrib.postgres.html>&#9656; postgres</a> </li><li><a href=django.contrib.redirects.html>&#9656; redirects</a> </li><li><a href=django.contrib.sessions.html>&#9656; sessions</a> </li><li><a href=django.contrib.sitemaps.html>&#9656; sitemaps</a> </li><li><a href=django.contrib.sites.html>&#9656; sites</a> </li><li><a href=django.contrib.staticfiles.html>&#9656; staticfiles</a> </li><li><a href=django.contrib.syndication.html>&#9656; syndication</a> </li></ul></li><li><a href=django.core.html>&#9656; core</a> </li><li><a href=django.db.html>&#9656; db</a> </li><li><a href=django.dispatch.html>&#9656; dispatch</a> </li><li><a href=django.forms.html>&#9656; forms</a> </li><li><a href=django.http.html>&#9656; http</a> </li><li><a href=django.middleware.html>&#9656; middleware</a> </li><li><a href=django.shortcuts.html>&#9656; shortcuts</a> </li><li><a href=django.template.html>&#9656; template</a> </li><li><a href=django.templatetags.html>&#9656; templatetags</a> </li><li><a href=django.test.html>&#9656; test</a> </li><li><a href=django.urls.html>&#9656; urls</a> </li><li><a href=django.utils.html>&#9656; utils</a> </li><li><a href=django.views.html>&#9656; views</a> </li></ul></ul></div></div><div class="content pure-u-1 pure-u-md-3-4"><h1>Source code django/contrib/gis/geos/geometry.py</h1><div id=path><a class=symbol href=django.html>django</a>.<a class=symbol href=django.contrib.html>contrib</a>.<a class=symbol href=django.contrib.gis.html>gis</a>.<a class=symbol href=django.contrib.gis.geos.html>geos</a>.<a class=symbol href=django.contrib.gis.geos.geometry.html>geometry</a></div><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668
669
670
671
672
673
674
675
676
677
678
679
680
681
682
683
684
685
686
687
688
689
690
691
692
693
694
695
696
697
698
699
700
701
702
703
704
705
706
707
708
709
710
711
712
713
714
715
716
717
718
719
720
721
722
723
724
725
726
727
728
729
730
731
732
733
734
735
736
737
738
739</pre></div></td><td class=code><div class=highlight><pre><span></span><a name=line-1></a><span class=sd>&quot;&quot;&quot;</span>
<a name=line-2></a><span class=sd> This module contains the &#39;base&#39; GEOSGeometry object -- all GEOS Geometries</span>
<a name=line-3></a><span class=sd> inherit from this object.</span>
<a name=line-4></a><span class=sd>&quot;&quot;&quot;</span>
<a name=line-5></a><span class=kn>import</span> <span class=nn>re</span>
<a name=line-6></a><span class=kn>from</span> <span class=nn>ctypes</span> <span class=kn>import</span> <span class=n>addressof</span><span class=p>,</span> <span class=n>byref</span><span class=p>,</span> <span class=n>c_double</span>
<a name=line-7></a>
<a name=line-8></a><span class=kn>from</span> <span class=nn>django.contrib.gis</span> <span class=kn>import</span> <span class=n>gdal</span>
<a name=line-9></a><span class=kn>from</span> <span class=nn>django.contrib.gis.geometry</span> <span class=kn>import</span> <span class=n>hex_regex</span><span class=p>,</span> <span class=n>json_regex</span><span class=p>,</span> <span class=n>wkt_regex</span>
<a name=line-10></a><span class=kn>from</span> <span class=nn>django.contrib.gis.geos</span> <span class=kn>import</span> <span class=n>prototypes</span> <span class=k>as</span> <span class=n>capi</span>
<a name=line-11></a><span class=kn>from</span> <span class=nn>django.contrib.gis.geos.base</span> <span class=kn>import</span> <span class=n>GEOSBase</span>
<a name=line-12></a><span class=kn>from</span> <span class=nn>django.contrib.gis.geos.coordseq</span> <span class=kn>import</span> <span class=n>GEOSCoordSeq</span>
<a name=line-13></a><span class=kn>from</span> <span class=nn>django.contrib.gis.geos.error</span> <span class=kn>import</span> <span class=n>GEOSException</span>
<a name=line-14></a><span class=kn>from</span> <span class=nn>django.contrib.gis.geos.libgeos</span> <span class=kn>import</span> <span class=n>GEOM_PTR</span>
<a name=line-15></a><span class=kn>from</span> <span class=nn>django.contrib.gis.geos.mutable_list</span> <span class=kn>import</span> <span class=n>ListMixin</span>
<a name=line-16></a><span class=kn>from</span> <span class=nn>django.contrib.gis.geos.prepared</span> <span class=kn>import</span> <span class=n>PreparedGeometry</span>
<a name=line-17></a><span class=kn>from</span> <span class=nn>django.contrib.gis.geos.prototypes.io</span> <span class=kn>import</span> <span class=p>(</span>
<a name=line-18></a>    <span class=n>ewkb_w</span><span class=p>,</span> <span class=n>wkb_r</span><span class=p>,</span> <span class=n>wkb_w</span><span class=p>,</span> <span class=n>wkt_r</span><span class=p>,</span> <span class=n>wkt_w</span><span class=p>,</span>
<a name=line-19></a><span class=p>)</span>
<a name=line-20></a><span class=kn>from</span> <span class=nn>django.utils.deconstruct</span> <span class=kn>import</span> <span class=n>deconstructible</span>
<a name=line-21></a><span class=kn>from</span> <span class=nn>django.utils.encoding</span> <span class=kn>import</span> <span class=n>force_bytes</span><span class=p>,</span> <span class=n>force_str</span>
<a name=line-22></a>
<a name=line-23></a>
<a name=line-24></a><span class=k>class</span> <span class=nc>GEOSGeometryBase</span><span class=p>(</span><span class=n>GEOSBase</span><span class=p>):</span>
<a name=line-25></a>
<a name=line-26></a>    <span class=n>_GEOS_CLASSES</span> <span class=o>=</span> <span class=kc>None</span>
<a name=line-27></a>
<a name=line-28></a>    <span class=n>ptr_type</span> <span class=o>=</span> <span class=n>GEOM_PTR</span>
<a name=line-29></a>    <span class=n>destructor</span> <span class=o>=</span> <span class=n>capi</span><span class=o>.</span><span class=n>destroy_geom</span>
<a name=line-30></a>    <span class=n>has_cs</span> <span class=o>=</span> <span class=kc>False</span>  <span class=c1># Only Point, LineString, LinearRing have coordinate sequences</span>
<a name=line-31></a>
<a name=line-32></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ptr</span><span class=p>,</span> <span class=bp>cls</span><span class=p>):</span>
<a name=line-33></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_ptr</span> <span class=o>=</span> <span class=n>ptr</span>
<a name=line-34></a>
<a name=line-35></a>        <span class=c1># Setting the class type (e.g., Point, Polygon, etc.)</span>
<a name=line-36></a>        <span class=k>if</span> <span class=nb>type</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=ow>in</span> <span class=p>(</span><span class=n>GEOSGeometryBase</span><span class=p>,</span> <span class=n>GEOSGeometry</span><span class=p>):</span>
<a name=line-37></a>            <span class=k>if</span> <span class=bp>cls</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<a name=line-38></a>                <span class=k>if</span> <span class=n>GEOSGeometryBase</span><span class=o>.</span><span class=n>_GEOS_CLASSES</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<a name=line-39></a>                    <span class=c1># Inner imports avoid import conflicts with GEOSGeometry.</span>
<a name=line-40></a>                    <span class=kn>from</span> <span class=nn>.collections</span> <span class=kn>import</span> <span class=p>(</span>
<a name=line-41></a>                        <span class=n>GeometryCollection</span><span class=p>,</span> <span class=n>MultiLineString</span><span class=p>,</span> <span class=n>MultiPoint</span><span class=p>,</span>
<a name=line-42></a>                        <span class=n>MultiPolygon</span><span class=p>,</span>
<a name=line-43></a>                    <span class=p>)</span>
<a name=line-44></a>                    <span class=kn>from</span> <span class=nn>.linestring</span> <span class=kn>import</span> <span class=n>LinearRing</span><span class=p>,</span> <span class=n>LineString</span>
<a name=line-45></a>                    <span class=kn>from</span> <span class=nn>.point</span> <span class=kn>import</span> <span class=n>Point</span>
<a name=line-46></a>                    <span class=kn>from</span> <span class=nn>.polygon</span> <span class=kn>import</span> <span class=n>Polygon</span>
<a name=line-47></a>                    <span class=n>GEOSGeometryBase</span><span class=o>.</span><span class=n>_GEOS_CLASSES</span> <span class=o>=</span> <span class=p>{</span>
<a name=line-48></a>                        <span class=mi>0</span><span class=p>:</span> <span class=n>Point</span><span class=p>,</span>
<a name=line-49></a>                        <span class=mi>1</span><span class=p>:</span> <span class=n>LineString</span><span class=p>,</span>
<a name=line-50></a>                        <span class=mi>2</span><span class=p>:</span> <span class=n>LinearRing</span><span class=p>,</span>
<a name=line-51></a>                        <span class=mi>3</span><span class=p>:</span> <span class=n>Polygon</span><span class=p>,</span>
<a name=line-52></a>                        <span class=mi>4</span><span class=p>:</span> <span class=n>MultiPoint</span><span class=p>,</span>
<a name=line-53></a>                        <span class=mi>5</span><span class=p>:</span> <span class=n>MultiLineString</span><span class=p>,</span>
<a name=line-54></a>                        <span class=mi>6</span><span class=p>:</span> <span class=n>MultiPolygon</span><span class=p>,</span>
<a name=line-55></a>                        <span class=mi>7</span><span class=p>:</span> <span class=n>GeometryCollection</span><span class=p>,</span>
<a name=line-56></a>                    <span class=p>}</span>
<a name=line-57></a>                <span class=bp>cls</span> <span class=o>=</span> <span class=n>GEOSGeometryBase</span><span class=o>.</span><span class=n>_GEOS_CLASSES</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>geom_typeid</span><span class=p>]</span>
<a name=line-58></a>            <span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span> <span class=o>=</span> <span class=bp>cls</span>
<a name=line-59></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_post_init</span><span class=p>()</span>
<a name=line-60></a>
<a name=line-61></a>    <span class=k>def</span> <span class=nf>_post_init</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-62></a>        <span class=s2>&quot;Perform post-initialization setup.&quot;</span>
<a name=line-63></a>        <span class=c1># Setting the coordinate sequence for the geometry (will be None on</span>
<a name=line-64></a>        <span class=c1># geometries that do not have coordinate sequences)</span>
<a name=line-65></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_cs</span> <span class=o>=</span> <span class=n>GEOSCoordSeq</span><span class=p>(</span><span class=n>capi</span><span class=o>.</span><span class=n>get_cs</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>),</span> <span class=bp>self</span><span class=o>.</span><span class=n>hasz</span><span class=p>)</span> <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>has_cs</span> <span class=k>else</span> <span class=kc>None</span>
<a name=line-66></a>
<a name=line-67></a>    <span class=k>def</span> <span class=nf>__copy__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-68></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-69></a><span class=sd>        Return a clone because the copy of a GEOSGeometry may contain an</span>
<a name=line-70></a><span class=sd>        invalid pointer location if the original is garbage collected.</span>
<a name=line-71></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-72></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>clone</span><span class=p>()</span>
<a name=line-73></a>
<a name=line-74></a>    <span class=k>def</span> <span class=nf>__deepcopy__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>memodict</span><span class=p>):</span>
<a name=line-75></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-76></a><span class=sd>        The `deepcopy` routine is used by the `Node` class of django.utils.tree;</span>
<a name=line-77></a><span class=sd>        thus, the protocol routine needs to be implemented to return correct</span>
<a name=line-78></a><span class=sd>        copies (clones) of these GEOS objects, which use C pointers.</span>
<a name=line-79></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-80></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>clone</span><span class=p>()</span>
<a name=line-81></a>
<a name=line-82></a>    <span class=k>def</span> <span class=fm>__str__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-83></a>        <span class=s2>&quot;EWKT is used for the string representation.&quot;</span>
<a name=line-84></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>ewkt</span>
<a name=line-85></a>
<a name=line-86></a>    <span class=k>def</span> <span class=fm>__repr__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-87></a>        <span class=s2>&quot;Short-hand representation because WKT may be very large.&quot;</span>
<a name=line-88></a>        <span class=k>return</span> <span class=s1>&#39;&lt;</span><span class=si>%s</span><span class=s1> object at </span><span class=si>%s</span><span class=s1>&gt;&#39;</span> <span class=o>%</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>geom_type</span><span class=p>,</span> <span class=nb>hex</span><span class=p>(</span><span class=n>addressof</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>)))</span>
<a name=line-89></a>
<a name=line-90></a>    <span class=c1># Pickling support</span>
<a name=line-91></a>    <span class=k>def</span> <span class=nf>_to_pickle_wkb</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-92></a>        <span class=k>return</span> <span class=nb>bytes</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>wkb</span><span class=p>)</span>
<a name=line-93></a>
<a name=line-94></a>    <span class=k>def</span> <span class=nf>_from_pickle_wkb</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>wkb</span><span class=p>):</span>
<a name=line-95></a>        <span class=k>return</span> <span class=n>wkb_r</span><span class=p>()</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=nb>memoryview</span><span class=p>(</span><span class=n>wkb</span><span class=p>))</span>
<a name=line-96></a>
<a name=line-97></a>    <span class=k>def</span> <span class=nf>__getstate__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-98></a>        <span class=c1># The pickled state is simply a tuple of the WKB (in string form)</span>
<a name=line-99></a>        <span class=c1># and the SRID.</span>
<a name=line-100></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_to_pickle_wkb</span><span class=p>(),</span> <span class=bp>self</span><span class=o>.</span><span class=n>srid</span>
<a name=line-101></a>
<a name=line-102></a>    <span class=k>def</span> <span class=nf>__setstate__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>state</span><span class=p>):</span>
<a name=line-103></a>        <span class=c1># Instantiating from the tuple state that was pickled.</span>
<a name=line-104></a>        <span class=n>wkb</span><span class=p>,</span> <span class=n>srid</span> <span class=o>=</span> <span class=n>state</span>
<a name=line-105></a>        <span class=n>ptr</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_from_pickle_wkb</span><span class=p>(</span><span class=n>wkb</span><span class=p>)</span>
<a name=line-106></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>ptr</span><span class=p>:</span>
<a name=line-107></a>            <span class=k>raise</span> <span class=n>GEOSException</span><span class=p>(</span><span class=s1>&#39;Invalid Geometry loaded from pickled state.&#39;</span><span class=p>)</span>
<a name=line-108></a>        <span class=bp>self</span><span class=o>.</span><span class=n>ptr</span> <span class=o>=</span> <span class=n>ptr</span>
<a name=line-109></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_post_init</span><span class=p>()</span>
<a name=line-110></a>        <span class=bp>self</span><span class=o>.</span><span class=n>srid</span> <span class=o>=</span> <span class=n>srid</span>
<a name=line-111></a>
<a name=line-112></a>    <span class=nd>@classmethod</span>
<a name=line-113></a>    <span class=k>def</span> <span class=nf>_from_wkb</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>wkb</span><span class=p>):</span>
<a name=line-114></a>        <span class=k>return</span> <span class=n>wkb_r</span><span class=p>()</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=n>wkb</span><span class=p>)</span>
<a name=line-115></a>
<a name=line-116></a>    <span class=nd>@staticmethod</span>
<a name=line-117></a>    <span class=k>def</span> <span class=nf>from_ewkt</span><span class=p>(</span><span class=n>ewkt</span><span class=p>):</span>
<a name=line-118></a>        <span class=n>ewkt</span> <span class=o>=</span> <span class=n>force_bytes</span><span class=p>(</span><span class=n>ewkt</span><span class=p>)</span>
<a name=line-119></a>        <span class=n>srid</span> <span class=o>=</span> <span class=kc>None</span>
<a name=line-120></a>        <span class=n>parts</span> <span class=o>=</span> <span class=n>ewkt</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;;&#39;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
<a name=line-121></a>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>parts</span><span class=p>)</span> <span class=o>==</span> <span class=mi>2</span><span class=p>:</span>
<a name=line-122></a>            <span class=n>srid_part</span><span class=p>,</span> <span class=n>wkt</span> <span class=o>=</span> <span class=n>parts</span>
<a name=line-123></a>            <span class=n>match</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>match</span><span class=p>(</span><span class=sa>br</span><span class=s1>&#39;SRID=(?P&lt;srid&gt;\-?\d+)&#39;</span><span class=p>,</span> <span class=n>srid_part</span><span class=p>)</span>
<a name=line-124></a>            <span class=k>if</span> <span class=ow>not</span> <span class=n>match</span><span class=p>:</span>
<a name=line-125></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s1>&#39;EWKT has invalid SRID part.&#39;</span><span class=p>)</span>
<a name=line-126></a>            <span class=n>srid</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>match</span><span class=p>[</span><span class=s1>&#39;srid&#39;</span><span class=p>])</span>
<a name=line-127></a>        <span class=k>else</span><span class=p>:</span>
<a name=line-128></a>            <span class=n>wkt</span> <span class=o>=</span> <span class=n>ewkt</span>
<a name=line-129></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>wkt</span><span class=p>:</span>
<a name=line-130></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s1>&#39;Expected WKT but got an empty string.&#39;</span><span class=p>)</span>
<a name=line-131></a>        <span class=k>return</span> <span class=n>GEOSGeometry</span><span class=p>(</span><span class=n>GEOSGeometry</span><span class=o>.</span><span class=n>_from_wkt</span><span class=p>(</span><span class=n>wkt</span><span class=p>),</span> <span class=n>srid</span><span class=o>=</span><span class=n>srid</span><span class=p>)</span>
<a name=line-132></a>
<a name=line-133></a>    <span class=nd>@staticmethod</span>
<a name=line-134></a>    <span class=k>def</span> <span class=nf>_from_wkt</span><span class=p>(</span><span class=n>wkt</span><span class=p>):</span>
<a name=line-135></a>        <span class=k>return</span> <span class=n>wkt_r</span><span class=p>()</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=n>wkt</span><span class=p>)</span>
<a name=line-136></a>
<a name=line-137></a>    <span class=nd>@classmethod</span>
<a name=line-138></a>    <span class=k>def</span> <span class=nf>from_gml</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>gml_string</span><span class=p>):</span>
<a name=line-139></a>        <span class=k>return</span> <span class=n>gdal</span><span class=o>.</span><span class=n>OGRGeometry</span><span class=o>.</span><span class=n>from_gml</span><span class=p>(</span><span class=n>gml_string</span><span class=p>)</span><span class=o>.</span><span class=n>geos</span>
<a name=line-140></a>
<a name=line-141></a>    <span class=c1># Comparison operators</span>
<a name=line-142></a>    <span class=k>def</span> <span class=fm>__eq__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
<a name=line-143></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-144></a><span class=sd>        Equivalence testing, a Geometry may be compared with another Geometry</span>
<a name=line-145></a><span class=sd>        or an EWKT representation.</span>
<a name=line-146></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-147></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>other</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
<a name=line-148></a>            <span class=k>try</span><span class=p>:</span>
<a name=line-149></a>                <span class=n>other</span> <span class=o>=</span> <span class=n>GEOSGeometry</span><span class=o>.</span><span class=n>from_ewkt</span><span class=p>(</span><span class=n>other</span><span class=p>)</span>
<a name=line-150></a>            <span class=k>except</span> <span class=p>(</span><span class=ne>ValueError</span><span class=p>,</span> <span class=n>GEOSException</span><span class=p>):</span>
<a name=line-151></a>                <span class=k>return</span> <span class=kc>False</span>
<a name=line-152></a>        <span class=k>return</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>other</span><span class=p>,</span> <span class=n>GEOSGeometry</span><span class=p>)</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>srid</span> <span class=o>==</span> <span class=n>other</span><span class=o>.</span><span class=n>srid</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>equals_exact</span><span class=p>(</span><span class=n>other</span><span class=p>)</span>
<a name=line-153></a>
<a name=line-154></a>    <span class=k>def</span> <span class=fm>__hash__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-155></a>        <span class=k>return</span> <span class=nb>hash</span><span class=p>((</span><span class=bp>self</span><span class=o>.</span><span class=n>srid</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>wkt</span><span class=p>))</span>
<a name=line-156></a>
<a name=line-157></a>    <span class=c1># ### Geometry set-like operations ###</span>
<a name=line-158></a>    <span class=c1># Thanks to Sean Gillies for inspiration:</span>
<a name=line-159></a>    <span class=c1>#  http://lists.gispython.org/pipermail/community/2007-July/001034.html</span>
<a name=line-160></a>    <span class=c1># g = g1 | g2</span>
<a name=line-161></a>    <span class=k>def</span> <span class=fm>__or__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
<a name=line-162></a>        <span class=s2>&quot;Return the union of this Geometry and the other.&quot;</span>
<a name=line-163></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>union</span><span class=p>(</span><span class=n>other</span><span class=p>)</span>
<a name=line-164></a>
<a name=line-165></a>    <span class=c1># g = g1 &amp; g2</span>
<a name=line-166></a>    <span class=k>def</span> <span class=fm>__and__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
<a name=line-167></a>        <span class=s2>&quot;Return the intersection of this Geometry and the other.&quot;</span>
<a name=line-168></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>intersection</span><span class=p>(</span><span class=n>other</span><span class=p>)</span>
<a name=line-169></a>
<a name=line-170></a>    <span class=c1># g = g1 - g2</span>
<a name=line-171></a>    <span class=k>def</span> <span class=fm>__sub__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
<a name=line-172></a>        <span class=s2>&quot;Return the difference this Geometry and the other.&quot;</span>
<a name=line-173></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>difference</span><span class=p>(</span><span class=n>other</span><span class=p>)</span>
<a name=line-174></a>
<a name=line-175></a>    <span class=c1># g = g1 ^ g2</span>
<a name=line-176></a>    <span class=k>def</span> <span class=fm>__xor__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
<a name=line-177></a>        <span class=s2>&quot;Return the symmetric difference of this Geometry and the other.&quot;</span>
<a name=line-178></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>sym_difference</span><span class=p>(</span><span class=n>other</span><span class=p>)</span>
<a name=line-179></a>
<a name=line-180></a>    <span class=c1># #### Coordinate Sequence Routines ####</span>
<a name=line-181></a>    <span class=nd>@property</span>
<a name=line-182></a>    <span class=k>def</span> <span class=nf>coord_seq</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-183></a>        <span class=s2>&quot;Return a clone of the coordinate sequence for this Geometry.&quot;</span>
<a name=line-184></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>has_cs</span><span class=p>:</span>
<a name=line-185></a>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_cs</span><span class=o>.</span><span class=n>clone</span><span class=p>()</span>
<a name=line-186></a>
<a name=line-187></a>    <span class=c1># #### Geometry Info ####</span>
<a name=line-188></a>    <span class=nd>@property</span>
<a name=line-189></a>    <span class=k>def</span> <span class=nf>geom_type</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-190></a>        <span class=s2>&quot;Return a string representing the Geometry type, e.g. &#39;Polygon&#39;&quot;</span>
<a name=line-191></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_type</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
<a name=line-192></a>
<a name=line-193></a>    <span class=nd>@property</span>
<a name=line-194></a>    <span class=k>def</span> <span class=nf>geom_typeid</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-195></a>        <span class=s2>&quot;Return an integer representing the Geometry type.&quot;</span>
<a name=line-196></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_typeid</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span>
<a name=line-197></a>
<a name=line-198></a>    <span class=nd>@property</span>
<a name=line-199></a>    <span class=k>def</span> <span class=nf>num_geom</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-200></a>        <span class=s2>&quot;Return the number of geometries in the Geometry.&quot;</span>
<a name=line-201></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>get_num_geoms</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span>
<a name=line-202></a>
<a name=line-203></a>    <span class=nd>@property</span>
<a name=line-204></a>    <span class=k>def</span> <span class=nf>num_coords</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-205></a>        <span class=s2>&quot;Return the number of coordinates in the Geometry.&quot;</span>
<a name=line-206></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>get_num_coords</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span>
<a name=line-207></a>
<a name=line-208></a>    <span class=nd>@property</span>
<a name=line-209></a>    <span class=k>def</span> <span class=nf>num_points</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-210></a>        <span class=s2>&quot;Return the number points, or coordinates, in the Geometry.&quot;</span>
<a name=line-211></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>num_coords</span>
<a name=line-212></a>
<a name=line-213></a>    <span class=nd>@property</span>
<a name=line-214></a>    <span class=k>def</span> <span class=nf>dims</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-215></a>        <span class=s2>&quot;Return the dimension of this Geometry (0=point, 1=line, 2=surface).&quot;</span>
<a name=line-216></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>get_dims</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span>
<a name=line-217></a>
<a name=line-218></a>    <span class=k>def</span> <span class=nf>normalize</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-219></a>        <span class=s2>&quot;Convert this Geometry to normal form (or canonical form).&quot;</span>
<a name=line-220></a>        <span class=n>capi</span><span class=o>.</span><span class=n>geos_normalize</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span>
<a name=line-221></a>
<a name=line-222></a>    <span class=c1># #### Unary predicates ####</span>
<a name=line-223></a>    <span class=nd>@property</span>
<a name=line-224></a>    <span class=k>def</span> <span class=nf>empty</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-225></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-226></a><span class=sd>        Return a boolean indicating whether the set of points in this Geometry</span>
<a name=line-227></a><span class=sd>        are empty.</span>
<a name=line-228></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-229></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_isempty</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span>
<a name=line-230></a>
<a name=line-231></a>    <span class=nd>@property</span>
<a name=line-232></a>    <span class=k>def</span> <span class=nf>hasz</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-233></a>        <span class=s2>&quot;Return whether the geometry has a 3D dimension.&quot;</span>
<a name=line-234></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_hasz</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span>
<a name=line-235></a>
<a name=line-236></a>    <span class=nd>@property</span>
<a name=line-237></a>    <span class=k>def</span> <span class=nf>ring</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-238></a>        <span class=s2>&quot;Return whether or not the geometry is a ring.&quot;</span>
<a name=line-239></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_isring</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span>
<a name=line-240></a>
<a name=line-241></a>    <span class=nd>@property</span>
<a name=line-242></a>    <span class=k>def</span> <span class=nf>simple</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-243></a>        <span class=s2>&quot;Return false if the Geometry isn&#39;t simple.&quot;</span>
<a name=line-244></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_issimple</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span>
<a name=line-245></a>
<a name=line-246></a>    <span class=nd>@property</span>
<a name=line-247></a>    <span class=k>def</span> <span class=nf>valid</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-248></a>        <span class=s2>&quot;Test the validity of this Geometry.&quot;</span>
<a name=line-249></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_isvalid</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span>
<a name=line-250></a>
<a name=line-251></a>    <span class=nd>@property</span>
<a name=line-252></a>    <span class=k>def</span> <span class=nf>valid_reason</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-253></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-254></a><span class=sd>        Return a string containing the reason for any invalidity.</span>
<a name=line-255></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-256></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_isvalidreason</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
<a name=line-257></a>
<a name=line-258></a>    <span class=c1># #### Binary predicates. ####</span>
<a name=line-259></a>    <span class=k>def</span> <span class=nf>contains</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
<a name=line-260></a>        <span class=s2>&quot;Return true if other.within(this) returns true.&quot;</span>
<a name=line-261></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_contains</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>other</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span>
<a name=line-262></a>
<a name=line-263></a>    <span class=k>def</span> <span class=nf>covers</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
<a name=line-264></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-265></a><span class=sd>        Return True if the DE-9IM Intersection Matrix for the two geometries is</span>
<a name=line-266></a><span class=sd>        T*****FF*, *T****FF*, ***T**FF*, or ****T*FF*. If either geometry is</span>
<a name=line-267></a><span class=sd>        empty, return False.</span>
<a name=line-268></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-269></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_covers</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>other</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span>
<a name=line-270></a>
<a name=line-271></a>    <span class=k>def</span> <span class=nf>crosses</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
<a name=line-272></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-273></a><span class=sd>        Return true if the DE-9IM intersection matrix for the two Geometries</span>
<a name=line-274></a><span class=sd>        is T*T****** (for a point and a curve,a point and an area or a line and</span>
<a name=line-275></a><span class=sd>        an area) 0******** (for two curves).</span>
<a name=line-276></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-277></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_crosses</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>other</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span>
<a name=line-278></a>
<a name=line-279></a>    <span class=k>def</span> <span class=nf>disjoint</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
<a name=line-280></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-281></a><span class=sd>        Return true if the DE-9IM intersection matrix for the two Geometries</span>
<a name=line-282></a><span class=sd>        is FF*FF****.</span>
<a name=line-283></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-284></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_disjoint</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>other</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span>
<a name=line-285></a>
<a name=line-286></a>    <span class=k>def</span> <span class=nf>equals</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
<a name=line-287></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-288></a><span class=sd>        Return true if the DE-9IM intersection matrix for the two Geometries</span>
<a name=line-289></a><span class=sd>        is T*F**FFF*.</span>
<a name=line-290></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-291></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_equals</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>other</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span>
<a name=line-292></a>
<a name=line-293></a>    <span class=k>def</span> <span class=nf>equals_exact</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>,</span> <span class=n>tolerance</span><span class=o>=</span><span class=mi>0</span><span class=p>):</span>
<a name=line-294></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-295></a><span class=sd>        Return true if the two Geometries are exactly equal, up to a</span>
<a name=line-296></a><span class=sd>        specified tolerance.</span>
<a name=line-297></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-298></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_equalsexact</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>other</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=nb>float</span><span class=p>(</span><span class=n>tolerance</span><span class=p>))</span>
<a name=line-299></a>
<a name=line-300></a>    <span class=k>def</span> <span class=nf>intersects</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
<a name=line-301></a>        <span class=s2>&quot;Return true if disjoint return false.&quot;</span>
<a name=line-302></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_intersects</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>other</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span>
<a name=line-303></a>
<a name=line-304></a>    <span class=k>def</span> <span class=nf>overlaps</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
<a name=line-305></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-306></a><span class=sd>        Return true if the DE-9IM intersection matrix for the two Geometries</span>
<a name=line-307></a><span class=sd>        is T*T***T** (for two points or two surfaces) 1*T***T** (for two curves).</span>
<a name=line-308></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-309></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_overlaps</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>other</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span>
<a name=line-310></a>
<a name=line-311></a>    <span class=k>def</span> <span class=nf>relate_pattern</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>,</span> <span class=n>pattern</span><span class=p>):</span>
<a name=line-312></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-313></a><span class=sd>        Return true if the elements in the DE-9IM intersection matrix for the</span>
<a name=line-314></a><span class=sd>        two Geometries match the elements in pattern.</span>
<a name=line-315></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-316></a>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>pattern</span><span class=p>,</span> <span class=nb>str</span><span class=p>)</span> <span class=ow>or</span> <span class=nb>len</span><span class=p>(</span><span class=n>pattern</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>9</span><span class=p>:</span>
<a name=line-317></a>            <span class=k>raise</span> <span class=n>GEOSException</span><span class=p>(</span><span class=s1>&#39;invalid intersection matrix pattern&#39;</span><span class=p>)</span>
<a name=line-318></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_relatepattern</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>other</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>force_bytes</span><span class=p>(</span><span class=n>pattern</span><span class=p>))</span>
<a name=line-319></a>
<a name=line-320></a>    <span class=k>def</span> <span class=nf>touches</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
<a name=line-321></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-322></a><span class=sd>        Return true if the DE-9IM intersection matrix for the two Geometries</span>
<a name=line-323></a><span class=sd>        is FT*******, F**T***** or F***T****.</span>
<a name=line-324></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-325></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_touches</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>other</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span>
<a name=line-326></a>
<a name=line-327></a>    <span class=k>def</span> <span class=nf>within</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
<a name=line-328></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-329></a><span class=sd>        Return true if the DE-9IM intersection matrix for the two Geometries</span>
<a name=line-330></a><span class=sd>        is T*F**F***.</span>
<a name=line-331></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-332></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_within</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>other</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span>
<a name=line-333></a>
<a name=line-334></a>    <span class=c1># #### SRID Routines ####</span>
<a name=line-335></a>    <span class=nd>@property</span>
<a name=line-336></a>    <span class=k>def</span> <span class=nf>srid</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-337></a>        <span class=s2>&quot;Get the SRID for the geometry. Return None if no SRID is set.&quot;</span>
<a name=line-338></a>        <span class=n>s</span> <span class=o>=</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_get_srid</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span>
<a name=line-339></a>        <span class=k>if</span> <span class=n>s</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
<a name=line-340></a>            <span class=k>return</span> <span class=kc>None</span>
<a name=line-341></a>        <span class=k>else</span><span class=p>:</span>
<a name=line-342></a>            <span class=k>return</span> <span class=n>s</span>
<a name=line-343></a>
<a name=line-344></a>    <span class=nd>@srid</span><span class=o>.</span><span class=n>setter</span>
<a name=line-345></a>    <span class=k>def</span> <span class=nf>srid</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>srid</span><span class=p>):</span>
<a name=line-346></a>        <span class=s2>&quot;Set the SRID for the geometry.&quot;</span>
<a name=line-347></a>        <span class=n>capi</span><span class=o>.</span><span class=n>geos_set_srid</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=mi>0</span> <span class=k>if</span> <span class=n>srid</span> <span class=ow>is</span> <span class=kc>None</span> <span class=k>else</span> <span class=n>srid</span><span class=p>)</span>
<a name=line-348></a>
<a name=line-349></a>    <span class=c1># #### Output Routines ####</span>
<a name=line-350></a>    <span class=nd>@property</span>
<a name=line-351></a>    <span class=k>def</span> <span class=nf>ewkt</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-352></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-353></a><span class=sd>        Return the EWKT (SRID + WKT) of the Geometry.</span>
<a name=line-354></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-355></a>        <span class=n>srid</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>srid</span>
<a name=line-356></a>        <span class=k>return</span> <span class=s1>&#39;SRID=</span><span class=si>%s</span><span class=s1>;</span><span class=si>%s</span><span class=s1>&#39;</span> <span class=o>%</span> <span class=p>(</span><span class=n>srid</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>wkt</span><span class=p>)</span> <span class=k>if</span> <span class=n>srid</span> <span class=k>else</span> <span class=bp>self</span><span class=o>.</span><span class=n>wkt</span>
<a name=line-357></a>
<a name=line-358></a>    <span class=nd>@property</span>
<a name=line-359></a>    <span class=k>def</span> <span class=nf>wkt</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-360></a>        <span class=s2>&quot;Return the WKT (Well-Known Text) representation of this Geometry.&quot;</span>
<a name=line-361></a>        <span class=k>return</span> <span class=n>wkt_w</span><span class=p>(</span><span class=n>dim</span><span class=o>=</span><span class=mi>3</span> <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>hasz</span> <span class=k>else</span> <span class=mi>2</span><span class=p>,</span> <span class=n>trim</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
<a name=line-362></a>
<a name=line-363></a>    <span class=nd>@property</span>
<a name=line-364></a>    <span class=k>def</span> <span class=nf>hex</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-365></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-366></a><span class=sd>        Return the WKB of this Geometry in hexadecimal form. Please note</span>
<a name=line-367></a><span class=sd>        that the SRID is not included in this representation because it is not</span>
<a name=line-368></a><span class=sd>        a part of the OGC specification (use the `hexewkb` property instead).</span>
<a name=line-369></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-370></a>        <span class=c1># A possible faster, all-python, implementation:</span>
<a name=line-371></a>        <span class=c1>#  str(self.wkb).encode(&#39;hex&#39;)</span>
<a name=line-372></a>        <span class=k>return</span> <span class=n>wkb_w</span><span class=p>(</span><span class=n>dim</span><span class=o>=</span><span class=mi>3</span> <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>hasz</span> <span class=k>else</span> <span class=mi>2</span><span class=p>)</span><span class=o>.</span><span class=n>write_hex</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span>
<a name=line-373></a>
<a name=line-374></a>    <span class=nd>@property</span>
<a name=line-375></a>    <span class=k>def</span> <span class=nf>hexewkb</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-376></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-377></a><span class=sd>        Return the EWKB of this Geometry in hexadecimal form. This is an</span>
<a name=line-378></a><span class=sd>        extension of the WKB specification that includes SRID value that are</span>
<a name=line-379></a><span class=sd>        a part of this geometry.</span>
<a name=line-380></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-381></a>        <span class=k>return</span> <span class=n>ewkb_w</span><span class=p>(</span><span class=n>dim</span><span class=o>=</span><span class=mi>3</span> <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>hasz</span> <span class=k>else</span> <span class=mi>2</span><span class=p>)</span><span class=o>.</span><span class=n>write_hex</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span>
<a name=line-382></a>
<a name=line-383></a>    <span class=nd>@property</span>
<a name=line-384></a>    <span class=k>def</span> <span class=nf>json</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-385></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-386></a><span class=sd>        Return GeoJSON representation of this Geometry.</span>
<a name=line-387></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-388></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>ogr</span><span class=o>.</span><span class=n>json</span>
<a name=line-389></a>    <span class=n>geojson</span> <span class=o>=</span> <span class=n>json</span>
<a name=line-390></a>
<a name=line-391></a>    <span class=nd>@property</span>
<a name=line-392></a>    <span class=k>def</span> <span class=nf>wkb</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-393></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-394></a><span class=sd>        Return the WKB (Well-Known Binary) representation of this Geometry</span>
<a name=line-395></a><span class=sd>        as a Python buffer.  SRID and Z values are not included, use the</span>
<a name=line-396></a><span class=sd>        `ewkb` property instead.</span>
<a name=line-397></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-398></a>        <span class=k>return</span> <span class=n>wkb_w</span><span class=p>(</span><span class=mi>3</span> <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>hasz</span> <span class=k>else</span> <span class=mi>2</span><span class=p>)</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span>
<a name=line-399></a>
<a name=line-400></a>    <span class=nd>@property</span>
<a name=line-401></a>    <span class=k>def</span> <span class=nf>ewkb</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-402></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-403></a><span class=sd>        Return the EWKB representation of this Geometry as a Python buffer.</span>
<a name=line-404></a><span class=sd>        This is an extension of the WKB specification that includes any SRID</span>
<a name=line-405></a><span class=sd>        value that are a part of this geometry.</span>
<a name=line-406></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-407></a>        <span class=k>return</span> <span class=n>ewkb_w</span><span class=p>(</span><span class=mi>3</span> <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>hasz</span> <span class=k>else</span> <span class=mi>2</span><span class=p>)</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span>
<a name=line-408></a>
<a name=line-409></a>    <span class=nd>@property</span>
<a name=line-410></a>    <span class=k>def</span> <span class=nf>kml</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-411></a>        <span class=s2>&quot;Return the KML representation of this Geometry.&quot;</span>
<a name=line-412></a>        <span class=n>gtype</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>geom_type</span>
<a name=line-413></a>        <span class=k>return</span> <span class=s1>&#39;&lt;</span><span class=si>%s</span><span class=s1>&gt;</span><span class=si>%s</span><span class=s1>&lt;/</span><span class=si>%s</span><span class=s1>&gt;&#39;</span> <span class=o>%</span> <span class=p>(</span><span class=n>gtype</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>coord_seq</span><span class=o>.</span><span class=n>kml</span><span class=p>,</span> <span class=n>gtype</span><span class=p>)</span>
<a name=line-414></a>
<a name=line-415></a>    <span class=nd>@property</span>
<a name=line-416></a>    <span class=k>def</span> <span class=nf>prepared</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-417></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-418></a><span class=sd>        Return a PreparedGeometry corresponding to this geometry -- it is</span>
<a name=line-419></a><span class=sd>        optimized for the contains, intersects, and covers operations.</span>
<a name=line-420></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-421></a>        <span class=k>return</span> <span class=n>PreparedGeometry</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span>
<a name=line-422></a>
<a name=line-423></a>    <span class=c1># #### GDAL-specific output routines ####</span>
<a name=line-424></a>    <span class=k>def</span> <span class=nf>_ogr_ptr</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-425></a>        <span class=k>return</span> <span class=n>gdal</span><span class=o>.</span><span class=n>OGRGeometry</span><span class=o>.</span><span class=n>_from_wkb</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>wkb</span><span class=p>)</span>
<a name=line-426></a>
<a name=line-427></a>    <span class=nd>@property</span>
<a name=line-428></a>    <span class=k>def</span> <span class=nf>ogr</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-429></a>        <span class=s2>&quot;Return the OGR Geometry for this Geometry.&quot;</span>
<a name=line-430></a>        <span class=k>return</span> <span class=n>gdal</span><span class=o>.</span><span class=n>OGRGeometry</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_ogr_ptr</span><span class=p>(),</span> <span class=bp>self</span><span class=o>.</span><span class=n>srs</span><span class=p>)</span>
<a name=line-431></a>
<a name=line-432></a>    <span class=nd>@property</span>
<a name=line-433></a>    <span class=k>def</span> <span class=nf>srs</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-434></a>        <span class=s2>&quot;Return the OSR SpatialReference for SRID of this Geometry.&quot;</span>
<a name=line-435></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>srid</span><span class=p>:</span>
<a name=line-436></a>            <span class=k>try</span><span class=p>:</span>
<a name=line-437></a>                <span class=k>return</span> <span class=n>gdal</span><span class=o>.</span><span class=n>SpatialReference</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>srid</span><span class=p>)</span>
<a name=line-438></a>            <span class=k>except</span> <span class=p>(</span><span class=n>gdal</span><span class=o>.</span><span class=n>GDALException</span><span class=p>,</span> <span class=n>gdal</span><span class=o>.</span><span class=n>SRSException</span><span class=p>):</span>
<a name=line-439></a>                <span class=k>pass</span>
<a name=line-440></a>        <span class=k>return</span> <span class=kc>None</span>
<a name=line-441></a>
<a name=line-442></a>    <span class=nd>@property</span>
<a name=line-443></a>    <span class=k>def</span> <span class=nf>crs</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-444></a>        <span class=s2>&quot;Alias for `srs` property.&quot;</span>
<a name=line-445></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>srs</span>
<a name=line-446></a>
<a name=line-447></a>    <span class=k>def</span> <span class=nf>transform</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ct</span><span class=p>,</span> <span class=n>clone</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
<a name=line-448></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-449></a><span class=sd>        Requires GDAL. Transform the geometry according to the given</span>
<a name=line-450></a><span class=sd>        transformation object, which may be an integer SRID, and WKT or</span>
<a name=line-451></a><span class=sd>        PROJ string. By default, transform the geometry in-place and return</span>
<a name=line-452></a><span class=sd>        nothing. However if the `clone` keyword is set, don&#39;t modify the</span>
<a name=line-453></a><span class=sd>        geometry and return a transformed clone instead.</span>
<a name=line-454></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-455></a>        <span class=n>srid</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>srid</span>
<a name=line-456></a>
<a name=line-457></a>        <span class=k>if</span> <span class=n>ct</span> <span class=o>==</span> <span class=n>srid</span><span class=p>:</span>
<a name=line-458></a>            <span class=c1># short-circuit where source &amp; dest SRIDs match</span>
<a name=line-459></a>            <span class=k>if</span> <span class=n>clone</span><span class=p>:</span>
<a name=line-460></a>                <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>clone</span><span class=p>()</span>
<a name=line-461></a>            <span class=k>else</span><span class=p>:</span>
<a name=line-462></a>                <span class=k>return</span>
<a name=line-463></a>
<a name=line-464></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>ct</span><span class=p>,</span> <span class=n>gdal</span><span class=o>.</span><span class=n>CoordTransform</span><span class=p>):</span>
<a name=line-465></a>            <span class=c1># We don&#39;t care about SRID because CoordTransform presupposes</span>
<a name=line-466></a>            <span class=c1># source SRS.</span>
<a name=line-467></a>            <span class=n>srid</span> <span class=o>=</span> <span class=kc>None</span>
<a name=line-468></a>        <span class=k>elif</span> <span class=n>srid</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>or</span> <span class=n>srid</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span>
<a name=line-469></a>            <span class=k>raise</span> <span class=n>GEOSException</span><span class=p>(</span><span class=s2>&quot;Calling transform() with no SRID set is not supported&quot;</span><span class=p>)</span>
<a name=line-470></a>
<a name=line-471></a>        <span class=c1># Creating an OGR Geometry, which is then transformed.</span>
<a name=line-472></a>        <span class=n>g</span> <span class=o>=</span> <span class=n>gdal</span><span class=o>.</span><span class=n>OGRGeometry</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_ogr_ptr</span><span class=p>(),</span> <span class=n>srid</span><span class=p>)</span>
<a name=line-473></a>        <span class=n>g</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>ct</span><span class=p>)</span>
<a name=line-474></a>        <span class=c1># Getting a new GEOS pointer</span>
<a name=line-475></a>        <span class=n>ptr</span> <span class=o>=</span> <span class=n>g</span><span class=o>.</span><span class=n>_geos_ptr</span><span class=p>()</span>
<a name=line-476></a>        <span class=k>if</span> <span class=n>clone</span><span class=p>:</span>
<a name=line-477></a>            <span class=c1># User wants a cloned transformed geometry returned.</span>
<a name=line-478></a>            <span class=k>return</span> <span class=n>GEOSGeometry</span><span class=p>(</span><span class=n>ptr</span><span class=p>,</span> <span class=n>srid</span><span class=o>=</span><span class=n>g</span><span class=o>.</span><span class=n>srid</span><span class=p>)</span>
<a name=line-479></a>        <span class=k>if</span> <span class=n>ptr</span><span class=p>:</span>
<a name=line-480></a>            <span class=c1># Reassigning pointer, and performing post-initialization setup</span>
<a name=line-481></a>            <span class=c1># again due to the reassignment.</span>
<a name=line-482></a>            <span class=n>capi</span><span class=o>.</span><span class=n>destroy_geom</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span>
<a name=line-483></a>            <span class=bp>self</span><span class=o>.</span><span class=n>ptr</span> <span class=o>=</span> <span class=n>ptr</span>
<a name=line-484></a>            <span class=bp>self</span><span class=o>.</span><span class=n>_post_init</span><span class=p>()</span>
<a name=line-485></a>            <span class=bp>self</span><span class=o>.</span><span class=n>srid</span> <span class=o>=</span> <span class=n>g</span><span class=o>.</span><span class=n>srid</span>
<a name=line-486></a>        <span class=k>else</span><span class=p>:</span>
<a name=line-487></a>            <span class=k>raise</span> <span class=n>GEOSException</span><span class=p>(</span><span class=s1>&#39;Transformed WKB was invalid.&#39;</span><span class=p>)</span>
<a name=line-488></a>
<a name=line-489></a>    <span class=c1># #### Topology Routines ####</span>
<a name=line-490></a>    <span class=k>def</span> <span class=nf>_topology</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>gptr</span><span class=p>):</span>
<a name=line-491></a>        <span class=s2>&quot;Return Geometry from the given pointer.&quot;</span>
<a name=line-492></a>        <span class=k>return</span> <span class=n>GEOSGeometry</span><span class=p>(</span><span class=n>gptr</span><span class=p>,</span> <span class=n>srid</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>srid</span><span class=p>)</span>
<a name=line-493></a>
<a name=line-494></a>    <span class=nd>@property</span>
<a name=line-495></a>    <span class=k>def</span> <span class=nf>boundary</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-496></a>        <span class=s2>&quot;Return the boundary as a newly allocated Geometry object.&quot;</span>
<a name=line-497></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_topology</span><span class=p>(</span><span class=n>capi</span><span class=o>.</span><span class=n>geos_boundary</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>))</span>
<a name=line-498></a>
<a name=line-499></a>    <span class=k>def</span> <span class=nf>buffer</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>width</span><span class=p>,</span> <span class=n>quadsegs</span><span class=o>=</span><span class=mi>8</span><span class=p>):</span>
<a name=line-500></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-501></a><span class=sd>        Return a geometry that represents all points whose distance from this</span>
<a name=line-502></a><span class=sd>        Geometry is less than or equal to distance. Calculations are in the</span>
<a name=line-503></a><span class=sd>        Spatial Reference System of this Geometry. The optional third parameter sets</span>
<a name=line-504></a><span class=sd>        the number of segment used to approximate a quarter circle (defaults to 8).</span>
<a name=line-505></a><span class=sd>        (Text from PostGIS documentation at ch. 6.1.3)</span>
<a name=line-506></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-507></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_topology</span><span class=p>(</span><span class=n>capi</span><span class=o>.</span><span class=n>geos_buffer</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>width</span><span class=p>,</span> <span class=n>quadsegs</span><span class=p>))</span>
<a name=line-508></a>
<a name=line-509></a>    <span class=k>def</span> <span class=nf>buffer_with_style</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>width</span><span class=p>,</span> <span class=n>quadsegs</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span> <span class=n>end_cap_style</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>join_style</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>mitre_limit</span><span class=o>=</span><span class=mf>5.0</span><span class=p>):</span>
<a name=line-510></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-511></a><span class=sd>        Same as buffer() but allows customizing the style of the buffer.</span>
<a name=line-512></a>
<a name=line-513></a><span class=sd>        End cap style can be round (1), flat (2), or square (3).</span>
<a name=line-514></a><span class=sd>        Join style can be round (1), mitre (2), or bevel (3).</span>
<a name=line-515></a><span class=sd>        Mitre ratio limit only affects mitered join style.</span>
<a name=line-516></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-517></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_topology</span><span class=p>(</span>
<a name=line-518></a>            <span class=n>capi</span><span class=o>.</span><span class=n>geos_bufferwithstyle</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>width</span><span class=p>,</span> <span class=n>quadsegs</span><span class=p>,</span> <span class=n>end_cap_style</span><span class=p>,</span> <span class=n>join_style</span><span class=p>,</span> <span class=n>mitre_limit</span><span class=p>),</span>
<a name=line-519></a>        <span class=p>)</span>
<a name=line-520></a>
<a name=line-521></a>    <span class=nd>@property</span>
<a name=line-522></a>    <span class=k>def</span> <span class=nf>centroid</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-523></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-524></a><span class=sd>        The centroid is equal to the centroid of the set of component Geometries</span>
<a name=line-525></a><span class=sd>        of highest dimension (since the lower-dimension geometries contribute zero</span>
<a name=line-526></a><span class=sd>        &quot;weight&quot; to the centroid).</span>
<a name=line-527></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-528></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_topology</span><span class=p>(</span><span class=n>capi</span><span class=o>.</span><span class=n>geos_centroid</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>))</span>
<a name=line-529></a>
<a name=line-530></a>    <span class=nd>@property</span>
<a name=line-531></a>    <span class=k>def</span> <span class=nf>convex_hull</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-532></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-533></a><span class=sd>        Return the smallest convex Polygon that contains all the points</span>
<a name=line-534></a><span class=sd>        in the Geometry.</span>
<a name=line-535></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-536></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_topology</span><span class=p>(</span><span class=n>capi</span><span class=o>.</span><span class=n>geos_convexhull</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>))</span>
<a name=line-537></a>
<a name=line-538></a>    <span class=k>def</span> <span class=nf>difference</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
<a name=line-539></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-540></a><span class=sd>        Return a Geometry representing the points making up this Geometry</span>
<a name=line-541></a><span class=sd>        that do not make up other.</span>
<a name=line-542></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-543></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_topology</span><span class=p>(</span><span class=n>capi</span><span class=o>.</span><span class=n>geos_difference</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>other</span><span class=o>.</span><span class=n>ptr</span><span class=p>))</span>
<a name=line-544></a>
<a name=line-545></a>    <span class=nd>@property</span>
<a name=line-546></a>    <span class=k>def</span> <span class=nf>envelope</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-547></a>        <span class=s2>&quot;Return the envelope for this geometry (a polygon).&quot;</span>
<a name=line-548></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_topology</span><span class=p>(</span><span class=n>capi</span><span class=o>.</span><span class=n>geos_envelope</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>))</span>
<a name=line-549></a>
<a name=line-550></a>    <span class=k>def</span> <span class=nf>intersection</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
<a name=line-551></a>        <span class=s2>&quot;Return a Geometry representing the points shared by this Geometry and other.&quot;</span>
<a name=line-552></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_topology</span><span class=p>(</span><span class=n>capi</span><span class=o>.</span><span class=n>geos_intersection</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>other</span><span class=o>.</span><span class=n>ptr</span><span class=p>))</span>
<a name=line-553></a>
<a name=line-554></a>    <span class=nd>@property</span>
<a name=line-555></a>    <span class=k>def</span> <span class=nf>point_on_surface</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-556></a>        <span class=s2>&quot;Compute an interior point of this Geometry.&quot;</span>
<a name=line-557></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_topology</span><span class=p>(</span><span class=n>capi</span><span class=o>.</span><span class=n>geos_pointonsurface</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>))</span>
<a name=line-558></a>
<a name=line-559></a>    <span class=k>def</span> <span class=nf>relate</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
<a name=line-560></a>        <span class=s2>&quot;Return the DE-9IM intersection matrix for this Geometry and the other.&quot;</span>
<a name=line-561></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_relate</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>other</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
<a name=line-562></a>
<a name=line-563></a>    <span class=k>def</span> <span class=nf>simplify</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>tolerance</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>preserve_topology</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
<a name=line-564></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-565></a><span class=sd>        Return the Geometry, simplified using the Douglas-Peucker algorithm</span>
<a name=line-566></a><span class=sd>        to the specified tolerance (higher tolerance =&gt; less points).  If no</span>
<a name=line-567></a><span class=sd>        tolerance provided, defaults to 0.</span>
<a name=line-568></a>
<a name=line-569></a><span class=sd>        By default, don&#39;t preserve topology - e.g. polygons can be split,</span>
<a name=line-570></a><span class=sd>        collapse to lines or disappear holes can be created or disappear, and</span>
<a name=line-571></a><span class=sd>        lines can cross. By specifying preserve_topology=True, the result will</span>
<a name=line-572></a><span class=sd>        have the same dimension and number of components as the input. This is</span>
<a name=line-573></a><span class=sd>        significantly slower.</span>
<a name=line-574></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-575></a>        <span class=k>if</span> <span class=n>preserve_topology</span><span class=p>:</span>
<a name=line-576></a>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_topology</span><span class=p>(</span><span class=n>capi</span><span class=o>.</span><span class=n>geos_preservesimplify</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>tolerance</span><span class=p>))</span>
<a name=line-577></a>        <span class=k>else</span><span class=p>:</span>
<a name=line-578></a>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_topology</span><span class=p>(</span><span class=n>capi</span><span class=o>.</span><span class=n>geos_simplify</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>tolerance</span><span class=p>))</span>
<a name=line-579></a>
<a name=line-580></a>    <span class=k>def</span> <span class=nf>sym_difference</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
<a name=line-581></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-582></a><span class=sd>        Return a set combining the points in this Geometry not in other,</span>
<a name=line-583></a><span class=sd>        and the points in other not in this Geometry.</span>
<a name=line-584></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-585></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_topology</span><span class=p>(</span><span class=n>capi</span><span class=o>.</span><span class=n>geos_symdifference</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>other</span><span class=o>.</span><span class=n>ptr</span><span class=p>))</span>
<a name=line-586></a>
<a name=line-587></a>    <span class=nd>@property</span>
<a name=line-588></a>    <span class=k>def</span> <span class=nf>unary_union</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-589></a>        <span class=s2>&quot;Return the union of all the elements of this geometry.&quot;</span>
<a name=line-590></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_topology</span><span class=p>(</span><span class=n>capi</span><span class=o>.</span><span class=n>geos_unary_union</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>))</span>
<a name=line-591></a>
<a name=line-592></a>    <span class=k>def</span> <span class=nf>union</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
<a name=line-593></a>        <span class=s2>&quot;Return a Geometry representing all the points in this Geometry and other.&quot;</span>
<a name=line-594></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_topology</span><span class=p>(</span><span class=n>capi</span><span class=o>.</span><span class=n>geos_union</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>other</span><span class=o>.</span><span class=n>ptr</span><span class=p>))</span>
<a name=line-595></a>
<a name=line-596></a>    <span class=c1># #### Other Routines ####</span>
<a name=line-597></a>    <span class=nd>@property</span>
<a name=line-598></a>    <span class=k>def</span> <span class=nf>area</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-599></a>        <span class=s2>&quot;Return the area of the Geometry.&quot;</span>
<a name=line-600></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_area</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>byref</span><span class=p>(</span><span class=n>c_double</span><span class=p>()))</span>
<a name=line-601></a>
<a name=line-602></a>    <span class=k>def</span> <span class=nf>distance</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
<a name=line-603></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-604></a><span class=sd>        Return the distance between the closest points on this Geometry</span>
<a name=line-605></a><span class=sd>        and the other. Units will be in those of the coordinate system of</span>
<a name=line-606></a><span class=sd>        the Geometry.</span>
<a name=line-607></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-608></a>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>other</span><span class=p>,</span> <span class=n>GEOSGeometry</span><span class=p>):</span>
<a name=line-609></a>            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=s1>&#39;distance() works only on other GEOS Geometries.&#39;</span><span class=p>)</span>
<a name=line-610></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_distance</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>other</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>byref</span><span class=p>(</span><span class=n>c_double</span><span class=p>()))</span>
<a name=line-611></a>
<a name=line-612></a>    <span class=nd>@property</span>
<a name=line-613></a>    <span class=k>def</span> <span class=nf>extent</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-614></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-615></a><span class=sd>        Return the extent of this geometry as a 4-tuple, consisting of</span>
<a name=line-616></a><span class=sd>        (xmin, ymin, xmax, ymax).</span>
<a name=line-617></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-618></a>        <span class=kn>from</span> <span class=nn>.point</span> <span class=kn>import</span> <span class=n>Point</span>
<a name=line-619></a>        <span class=n>env</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>envelope</span>
<a name=line-620></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>env</span><span class=p>,</span> <span class=n>Point</span><span class=p>):</span>
<a name=line-621></a>            <span class=n>xmin</span><span class=p>,</span> <span class=n>ymin</span> <span class=o>=</span> <span class=n>env</span><span class=o>.</span><span class=n>tuple</span>
<a name=line-622></a>            <span class=n>xmax</span><span class=p>,</span> <span class=n>ymax</span> <span class=o>=</span> <span class=n>xmin</span><span class=p>,</span> <span class=n>ymin</span>
<a name=line-623></a>        <span class=k>else</span><span class=p>:</span>
<a name=line-624></a>            <span class=n>xmin</span><span class=p>,</span> <span class=n>ymin</span> <span class=o>=</span> <span class=n>env</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span>
<a name=line-625></a>            <span class=n>xmax</span><span class=p>,</span> <span class=n>ymax</span> <span class=o>=</span> <span class=n>env</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>2</span><span class=p>]</span>
<a name=line-626></a>        <span class=k>return</span> <span class=p>(</span><span class=n>xmin</span><span class=p>,</span> <span class=n>ymin</span><span class=p>,</span> <span class=n>xmax</span><span class=p>,</span> <span class=n>ymax</span><span class=p>)</span>
<a name=line-627></a>
<a name=line-628></a>    <span class=nd>@property</span>
<a name=line-629></a>    <span class=k>def</span> <span class=nf>length</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-630></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-631></a><span class=sd>        Return the length of this Geometry (e.g., 0 for point, or the</span>
<a name=line-632></a><span class=sd>        circumference of a Polygon).</span>
<a name=line-633></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-634></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_length</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>byref</span><span class=p>(</span><span class=n>c_double</span><span class=p>()))</span>
<a name=line-635></a>
<a name=line-636></a>    <span class=k>def</span> <span class=nf>clone</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-637></a>        <span class=s2>&quot;Clone this Geometry.&quot;</span>
<a name=line-638></a>        <span class=k>return</span> <span class=n>GEOSGeometry</span><span class=p>(</span><span class=n>capi</span><span class=o>.</span><span class=n>geom_clone</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>))</span>
<a name=line-639></a>
<a name=line-640></a>
<a name=line-641></a><span class=k>class</span> <span class=nc>LinearGeometryMixin</span><span class=p>:</span>
<a name=line-642></a>    <span class=sd>&quot;&quot;&quot;</span>
<a name=line-643></a><span class=sd>    Used for LineString and MultiLineString.</span>
<a name=line-644></a><span class=sd>    &quot;&quot;&quot;</span>
<a name=line-645></a>    <span class=k>def</span> <span class=nf>interpolate</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>distance</span><span class=p>):</span>
<a name=line-646></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_topology</span><span class=p>(</span><span class=n>capi</span><span class=o>.</span><span class=n>geos_interpolate</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>distance</span><span class=p>))</span>
<a name=line-647></a>
<a name=line-648></a>    <span class=k>def</span> <span class=nf>interpolate_normalized</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>distance</span><span class=p>):</span>
<a name=line-649></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_topology</span><span class=p>(</span><span class=n>capi</span><span class=o>.</span><span class=n>geos_interpolate_normalized</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>distance</span><span class=p>))</span>
<a name=line-650></a>
<a name=line-651></a>    <span class=k>def</span> <span class=nf>project</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>point</span><span class=p>):</span>
<a name=line-652></a>        <span class=kn>from</span> <span class=nn>.point</span> <span class=kn>import</span> <span class=n>Point</span>
<a name=line-653></a>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>point</span><span class=p>,</span> <span class=n>Point</span><span class=p>):</span>
<a name=line-654></a>            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=s1>&#39;locate_point argument must be a Point&#39;</span><span class=p>)</span>
<a name=line-655></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_project</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>point</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span>
<a name=line-656></a>
<a name=line-657></a>    <span class=k>def</span> <span class=nf>project_normalized</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>point</span><span class=p>):</span>
<a name=line-658></a>        <span class=kn>from</span> <span class=nn>.point</span> <span class=kn>import</span> <span class=n>Point</span>
<a name=line-659></a>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>point</span><span class=p>,</span> <span class=n>Point</span><span class=p>):</span>
<a name=line-660></a>            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=s1>&#39;locate_point argument must be a Point&#39;</span><span class=p>)</span>
<a name=line-661></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_project_normalized</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>,</span> <span class=n>point</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span>
<a name=line-662></a>
<a name=line-663></a>    <span class=nd>@property</span>
<a name=line-664></a>    <span class=k>def</span> <span class=nf>merged</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-665></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-666></a><span class=sd>        Return the line merge of this Geometry.</span>
<a name=line-667></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-668></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_topology</span><span class=p>(</span><span class=n>capi</span><span class=o>.</span><span class=n>geos_linemerge</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>))</span>
<a name=line-669></a>
<a name=line-670></a>    <span class=nd>@property</span>
<a name=line-671></a>    <span class=k>def</span> <span class=nf>closed</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a name=line-672></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-673></a><span class=sd>        Return whether or not this Geometry is closed.</span>
<a name=line-674></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-675></a>        <span class=k>return</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_isclosed</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span>
<a name=line-676></a>
<a name=line-677></a>
<a name=line-678></a><span class=nd>@deconstructible</span>
<a name=line-679></a><span class=k>class</span> <span class=nc>GEOSGeometry</span><span class=p>(</span><span class=n>GEOSGeometryBase</span><span class=p>,</span> <span class=n>ListMixin</span><span class=p>):</span>
<a name=line-680></a>    <span class=s2>&quot;A class that, generally, encapsulates a GEOS geometry.&quot;</span>
<a name=line-681></a>
<a name=line-682></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>geo_input</span><span class=p>,</span> <span class=n>srid</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<a name=line-683></a>        <span class=sd>&quot;&quot;&quot;</span>
<a name=line-684></a><span class=sd>        The base constructor for GEOS geometry objects. It may take the</span>
<a name=line-685></a><span class=sd>        following inputs:</span>
<a name=line-686></a>
<a name=line-687></a><span class=sd>         * strings:</span>
<a name=line-688></a><span class=sd>            - WKT</span>
<a name=line-689></a><span class=sd>            - HEXEWKB (a PostGIS-specific canonical form)</span>
<a name=line-690></a><span class=sd>            - GeoJSON (requires GDAL)</span>
<a name=line-691></a><span class=sd>         * buffer:</span>
<a name=line-692></a><span class=sd>            - WKB</span>
<a name=line-693></a>
<a name=line-694></a><span class=sd>        The `srid` keyword specifies the Source Reference Identifier (SRID)</span>
<a name=line-695></a><span class=sd>        number for this Geometry. If not provided, it defaults to None.</span>
<a name=line-696></a><span class=sd>        &quot;&quot;&quot;</span>
<a name=line-697></a>        <span class=n>input_srid</span> <span class=o>=</span> <span class=kc>None</span>
<a name=line-698></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>geo_input</span><span class=p>,</span> <span class=nb>bytes</span><span class=p>):</span>
<a name=line-699></a>            <span class=n>geo_input</span> <span class=o>=</span> <span class=n>force_str</span><span class=p>(</span><span class=n>geo_input</span><span class=p>)</span>
<a name=line-700></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>geo_input</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
<a name=line-701></a>            <span class=n>wkt_m</span> <span class=o>=</span> <span class=n>wkt_regex</span><span class=o>.</span><span class=n>match</span><span class=p>(</span><span class=n>geo_input</span><span class=p>)</span>
<a name=line-702></a>            <span class=k>if</span> <span class=n>wkt_m</span><span class=p>:</span>
<a name=line-703></a>                <span class=c1># Handle WKT input.</span>
<a name=line-704></a>                <span class=k>if</span> <span class=n>wkt_m</span><span class=p>[</span><span class=s1>&#39;srid&#39;</span><span class=p>]:</span>
<a name=line-705></a>                    <span class=n>input_srid</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>wkt_m</span><span class=p>[</span><span class=s1>&#39;srid&#39;</span><span class=p>])</span>
<a name=line-706></a>                <span class=n>g</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_from_wkt</span><span class=p>(</span><span class=n>force_bytes</span><span class=p>(</span><span class=n>wkt_m</span><span class=p>[</span><span class=s1>&#39;wkt&#39;</span><span class=p>]))</span>
<a name=line-707></a>            <span class=k>elif</span> <span class=n>hex_regex</span><span class=o>.</span><span class=n>match</span><span class=p>(</span><span class=n>geo_input</span><span class=p>):</span>
<a name=line-708></a>                <span class=c1># Handle HEXEWKB input.</span>
<a name=line-709></a>                <span class=n>g</span> <span class=o>=</span> <span class=n>wkb_r</span><span class=p>()</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=n>force_bytes</span><span class=p>(</span><span class=n>geo_input</span><span class=p>))</span>
<a name=line-710></a>            <span class=k>elif</span> <span class=n>json_regex</span><span class=o>.</span><span class=n>match</span><span class=p>(</span><span class=n>geo_input</span><span class=p>):</span>
<a name=line-711></a>                <span class=c1># Handle GeoJSON input.</span>
<a name=line-712></a>                <span class=n>ogr</span> <span class=o>=</span> <span class=n>gdal</span><span class=o>.</span><span class=n>OGRGeometry</span><span class=o>.</span><span class=n>from_json</span><span class=p>(</span><span class=n>geo_input</span><span class=p>)</span>
<a name=line-713></a>                <span class=n>g</span> <span class=o>=</span> <span class=n>ogr</span><span class=o>.</span><span class=n>_geos_ptr</span><span class=p>()</span>
<a name=line-714></a>                <span class=n>input_srid</span> <span class=o>=</span> <span class=n>ogr</span><span class=o>.</span><span class=n>srid</span>
<a name=line-715></a>            <span class=k>else</span><span class=p>:</span>
<a name=line-716></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s1>&#39;String input unrecognized as WKT EWKT, and HEXEWKB.&#39;</span><span class=p>)</span>
<a name=line-717></a>        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>geo_input</span><span class=p>,</span> <span class=n>GEOM_PTR</span><span class=p>):</span>
<a name=line-718></a>            <span class=c1># When the input is a pointer to a geometry (GEOM_PTR).</span>
<a name=line-719></a>            <span class=n>g</span> <span class=o>=</span> <span class=n>geo_input</span>
<a name=line-720></a>        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>geo_input</span><span class=p>,</span> <span class=nb>memoryview</span><span class=p>):</span>
<a name=line-721></a>            <span class=c1># When the input is a buffer (WKB).</span>
<a name=line-722></a>            <span class=n>g</span> <span class=o>=</span> <span class=n>wkb_r</span><span class=p>()</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=n>geo_input</span><span class=p>)</span>
<a name=line-723></a>        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>geo_input</span><span class=p>,</span> <span class=n>GEOSGeometry</span><span class=p>):</span>
<a name=line-724></a>            <span class=n>g</span> <span class=o>=</span> <span class=n>capi</span><span class=o>.</span><span class=n>geom_clone</span><span class=p>(</span><span class=n>geo_input</span><span class=o>.</span><span class=n>ptr</span><span class=p>)</span>
<a name=line-725></a>        <span class=k>else</span><span class=p>:</span>
<a name=line-726></a>            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=s1>&#39;Improper geometry input type: </span><span class=si>%s</span><span class=s1>&#39;</span> <span class=o>%</span> <span class=nb>type</span><span class=p>(</span><span class=n>geo_input</span><span class=p>))</span>
<a name=line-727></a>
<a name=line-728></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>g</span><span class=p>:</span>
<a name=line-729></a>            <span class=k>raise</span> <span class=n>GEOSException</span><span class=p>(</span><span class=s1>&#39;Could not initialize GEOS Geometry with given input.&#39;</span><span class=p>)</span>
<a name=line-730></a>
<a name=line-731></a>        <span class=n>input_srid</span> <span class=o>=</span> <span class=n>input_srid</span> <span class=ow>or</span> <span class=n>capi</span><span class=o>.</span><span class=n>geos_get_srid</span><span class=p>(</span><span class=n>g</span><span class=p>)</span> <span class=ow>or</span> <span class=kc>None</span>
<a name=line-732></a>        <span class=k>if</span> <span class=n>input_srid</span> <span class=ow>and</span> <span class=n>srid</span> <span class=ow>and</span> <span class=n>input_srid</span> <span class=o>!=</span> <span class=n>srid</span><span class=p>:</span>
<a name=line-733></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s1>&#39;Input geometry already has SRID: </span><span class=si>%d</span><span class=s1>.&#39;</span> <span class=o>%</span> <span class=n>input_srid</span><span class=p>)</span>
<a name=line-734></a>
<a name=line-735></a>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>g</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
<a name=line-736></a>        <span class=c1># Set the SRID, if given.</span>
<a name=line-737></a>        <span class=n>srid</span> <span class=o>=</span> <span class=n>input_srid</span> <span class=ow>or</span> <span class=n>srid</span>
<a name=line-738></a>        <span class=k>if</span> <span class=n>srid</span> <span class=ow>and</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>srid</span><span class=p>,</span> <span class=nb>int</span><span class=p>):</span>
<a name=line-739></a>            <span class=bp>self</span><span class=o>.</span><span class=n>srid</span> <span class=o>=</span> <span class=n>srid</span>
</pre></div></td></tr></table><p class=footer> Generated by <a href=https://github.com/spirali/nedoc>nedoc</a> v0.9 at 2020-12-29 14:04 </p></div></div></body></html>